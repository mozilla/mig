<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>MIG: Mozilla InvestiGator by mozilla</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>MIG: Mozilla InvestiGator</h1>
        <h2>Mozilla OpSec&#39;s platform real-time digital forensic and incident response on remote endpoints.</h2>
        <section id="downloads">
          <table><tr>
            <td>
              <a href="https://github.com/mozilla/mig" class="btn">Source Code</a>
              <a href="doc.html" class="btn">Documentation</a>
              <a href="about.html" class="btn">About</a>
            </td>
            <td>
              <p><img src="http://4u.1nw.eu/mig-logo-transparent.png" alt="MIG logo" width="500"></p>
            </td>
          </tr></table>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <table><tr><td>
            <p>MIG is a platform to perform investigative surgery on remote endpoints. It enables investigators to obtain information from large numbers of systems in parallel, thus accelerating investigation of incidents.</p>
            <p>MIG is composed of agents installed on all systems of an infrastructure. The agents can be queried in real-time using a messenging protocol implemented in the MIG Scheduler. MIG has an API, a database, RabbitMQ relays and a console client. It allows investigators to send actions to pools of agents, and check for indicator of compromision, verify the state of a configuration, block an account, create a firewall rule, update a blacklist and so on.</p> 
        </td><td>
            <iframe width="500" height="315" src="https://www.youtube.com/embed/wJwj5YB6FFA&vq=hd720" frameborder="0" allowfullscreen></iframe>
        </td></tr></table>
        <p>It's an army of Sherlock Holmes, ready to interrogate your infrastructure within seconds.</p>
        <h2>Concepts</h2>
        <p>
        <h3>Search for IOCs in real-time</h3>
        For example: an investigator launches an action to search for an apache module
        that matches a given md5 value. MIG will register the action, find all the
        relevant targets and send commands to each target agent with the detail of the
        action. Each agent then individually runs the action using built-in modules,
        and sends the results back to the MIG platform.
        <br /><br />
        <h3>Easy to deploy, easy to operate</h3>
        Agents are designed to be lightweight, secure, and easy to deploy. All
        parameters are built into the agent at compile time, include the list of
        investigator's public keys. The agent binary is statically compiled for a target
        platform and can be shipped without any external dependency. Deploying an agent
        is as easy as running<br />
        <b>wget -O /sbin/mig-agent https://fileserver/mig-agent && sudo /sbin/mig-agent</b>
        <br /><br />
        <h3>Fast and asynchronous</h3>
        MIG is designed to be fast, and asynchronous. It uses AMQP to distribute actions
        to endpoints, and relies on Go channels to prevent components from blocking.
        Running actions and commands are stored on disk cache, and don't rely on running
        processes for reliability.
        <br /><br />
        Speed is a strong requirement. Most actions will only take a few hundreds
        milliseconds to run. Larger ones, for example when looking for a hash in a large
        directory, should run in less than a minute or two.
        <br /><br />
        <h3>Strong security primitives</h3>
        Privacy and security are paramount. Agents never send raw data back to the
        platform, but only reply to questions instead. All actions are signed by GPG
        keys that are not stored in the platform, thus preventing a compromision from
        taking over the entire infrastructure.
        </p>
        <h2>Format</h2>
        <p>
        Mozilla InvestiGator uses signed JSON actions. An action can represent an IOC
        (Indicator of Compromise), or a task to perform on an endpoint (update a firewall,
        create a user account, ...).
        The JSON format is designed to be easy to read and easy to write without the help
        of a program. The long term goal is to allow investigators to share documents easily.
        </p>
        <pre>
        {
            "name": "Linux backdoor, found on compromised host in 2014",
            "description": {
                "author": "Julien Vehent",
                "email": "julien@linuxwall.info",
                "revision": 201409031800
            },
            "target": "agents.os = 'linux'",
            "threat": {
                "level": "alert",
                "type": "system",
                "family": "backdoor"
            },
            "operations": [
                {
                    "module": "filechecker",
                    "parameters": {
                        "searches": {
                            "backdoors": {
                                "paths": [
                                    "/usr/bin/*",
                                    "/usr/sbin/*",
                                    "/bin/*",
                                    "/sbin/*",
                                    "/opt/*",
                                    "/tmp/*"
                                ],
                                "sha256": [
                                    "adbee847c12c73605ff657e668c8096df138f824eb542027a10c0b5c07619c8d",
                                    "7c9816b5f1b840eb8c5ecfc0fed29972877ca5bd909469d03f26d3b8f837043d",
                                    "3efee976d6565edd1492aa1047ffa10be6025de18206f6c68f91dd218801778f",
                                    "4735f97b31ddb8a1bbc61e8d66b4dbc08d8092142d8ae7564f9058e0a20bbbb6",
                                    "89a400077d74d1d76103180f41f40de6bcfffc89de461f497eef2ea763a68d73",
                                    "adbee847c12c73605ff657e668c8096df138f824eb542027a10c0b5c07619c8d",
                                    "939cc74b5343bde1a17dfa270f8e6dc719a4bc6b3143f4581b401c81fd9a110d",
                                    "89b68f8ea6a32d525fbf491878980180ffa395b042ea3104b11da229bade71db",
                                    "39823089fa324ceba00d5939d2e7b308fec28ee0f16c6caa4739a53ad6ecee64",
                                    "72a44f3e7c4d9c9b72b1bda77d687346447d8e398983965b8e690eeeadebdc76",
                                    "dbe7fc18667cd75317d494ed3b32cfe3cd077c870d015dc18b406a4a39747f55",
                                    "903c13171c7467271fd79244ad8281ded9f51e3cf27c3399b42a175c53806a99",
                                    "81dac9c6dc5e4ed615d496aea74fddc85925b00a6a54ddcbb90603c1469ce04c",
                                    "fd702be65b1d3abed4c0197854c0c777a2bb50632932e1e389129b19b14a1e69",
                                    "72589dd25b491ed53670bc7d04f4874075fc7d16361fc295c31fc86118d84cbd",
                                    "6114624bf5d7e29f738f939bcc2bc794de9bf377a571fe1e84ae9159794308cf",
                                    "467f34eee9d133653467a60ab0fe938d7c26918465a2ac938d2ffc6f2525b1ff",
                                    "1e2699ff1f9238c58390c1ada53f4f21032ca5e0946bfb54a5a144452e6efc82",
                                    "286c39ec3d8e4f15f353dca350ca7575e0269dba808206f3ce8d1a3ea142b353",
                                    "fc48883e129225dc8fc9e340a495fbd834c97f5ff7fa70ab6089ec216a465328",
                                    "5cba4433237e2ff202a5b20aad00a12d25bfc5564c3620a9463767eec2150cc1"
                                ]
                            }
                        }
                    }
                }
            ],
            "syntaxversion": 2
        }
        </pre>
        <h2>Console</h2>
        <p>
        The console is the terminal interface that allows investigators to control MIG.
        It is terminal based, and runs on Linux and MacOS.
        </p>
        <iframe width="960" height="720" src="//www.youtube.com/embed/3MeN0cN79L4?rel=0&vq=hd720" frameborder="0" allowfullscreen></iframe>
      </section>
    </div>
    <!-- Piwik -->
    <script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://linuxwall.info/webstats/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', 4]);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
        g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <noscript><p><img src="http://linuxwall.info/webstats/piwik.php?idsite=4" style="border:0;" alt="" /></p></noscript>
    <!-- End Piwik Code -->
  </body>
</html>
